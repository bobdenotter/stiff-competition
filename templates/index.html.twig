{% extends 'base.html.twig' %}

{% block updated %}Updated on {{ data|first['updated'] }}{% endblock %}

{% block body %}

    <h1>Stiff competition!</h1>

    {% set header = {
    'name': 'Name',
    'site': 'Site',
    'repository': 'Repository',
    'docs': 'Docs',
    'open_issues': 'Open Issues',
    'opened_recently': 'Recently opened / closed',
    'stargazers': 'Stargazers / Forks',
    'commits_year': 'Commits per Year / Month',
    'description': 'Description',
    'topics': 'Topics'
} %}

    <table class="table table-striped table-sm" id="competition">

    <thead>
        
    <tr>
        {% for columnname, column in header %}
            <th class="col-{{ columnname }}"
            ><a href="?order={{ columnname }}">{{ column }}</a></th>
        {% endfor %}
    </tr>
    </thead>

    {% for row in data %}

        <tr>
            {% for columnname, column in header %}
            <td class="col-{{ columnname }}">
            {% if columnname in ['site', 'repository', 'docs'] %}
                <a href="{{ row[columnname] }}">{{ row[columnname]|truncate(24) }}</a>
            {% else %}
                {{ row[columnname]|default('-')|join(', ')|truncate(120) }}
            {% endif %}
            {% if columnname == 'opened_recently' %}
                / {{ row['closed_recently'] }}
            {% endif %}
            {% if columnname == 'stargazers' %}
                / {{ row['forks'] }}
            {% endif %}
            {% if columnname == 'commits_year' %}
                / {{ row['commits_month'] }}
            {% endif %}
            </td>
        {% endfor %}
        </tr>
    {% endfor %}
    </table>

    {#{{ dump(data) }}#}

{% endblock %}

{% block javascripts %}
    {{ parent() }}
{% endblock %}